<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <style>
        body {
            padding: 100px;
            width: 1000px;
            margin: auto;
            text-align: left;
            font-weight: 300;
            font-family: 'Open Sans', sans-serif;
            color: #121212;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: 'Source Sans Pro', sans-serif;
        }

        code {
            background-color: lightgrey;
        }
    </style>
    <title>CS 184 Fracture Simulation</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">
    <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
</head>

<body>
    <br />
    <h1 align="middle">Final Project</h1>
    <h2 align="middle">Divi Schmidt and Joey Kraut</h2>
    <br><br>

    <h2>Abstract</h2>
    <p>
        This project's focus was on extending the cloth simulation of project 4 to simulate materials as they
        fracture and break in different ways. The project consisted of two primary components; code infrastructure
        changes and fracture modeling. Much of the work spent on this project involved making changes to underlying
        structure of the project like enabling forces to act on spheres, introducing resistive elastic forces from
        a mesh on a sphere, and modifying the shaders to enable fractured appearances. On the fracture modeling side,
        we implemented an approach from a paper we found which generated realistic looking tears. We then added our
        own ideas to this approach for more interesting tearing and fracturing effects.
    </p>

    <h2>Technical Approach</h2>
    <h3>Code Infrastructure Changes</h3>
    <h4>Enabling Forces on Spheres</h4>
    <p>
        The first code change necessary to the simulation backbone was to enable spheres to move as forces (e.g. gravity)
        are applied. This was necessary so that we could collide spheres with pinned meshes to analyze stretches and tears.
    </p>
    <p>
        To make this code change, we simply added a <code>simulate</code> method to the <code>collisionObject</code>
        class that is called for every collision object in the same loop that the cloth's <code>simulate</code> is.
        As well, we added a <code>Vector3D</code> force vector that accumulates forces applied to a sphere. The 
        sphere also maintains its first two moments so that we can update its position and velocity as in the
        pointmass mesh. At every simulation step, we update the sphere as a rigid body around its center which 
        moves according to the following equations $x_t$
        $$\begin{align} v_t & = k_dv_t + \Delta_t f / m \\ x_t & = x_{t-1} + \Delta_t * v_t \end{align}$$
        where $v$ is velocity, $x$ is position, $k_d$ is a damping coefficient, $f$ is the accumulated force
        vector, and $m$ is the sphere mass.
    </p>
    <p>
        The modeling assumption used here are that the sphere is accurately modeled as a rigid body.
    </p>
    <p>
        For the result of this code change see the first figure in the results.
    </p>

    <h4>Mesh Resistance</h4>
    <p>
        The second code change to enable realistic fracturing was to make the mesh resist the sphere by applying
        an opposing force to the sphere. To enable the cloth to apply a resistive force, we added a constant $k_r$
        to allow us to control the "stretchiness" of the mesh and added the following force point by point on 
        a collision to the sphere
        $$k_r||x_a - x_b|| * \frac{c - x_b}{||c - x_b||}$$
        where $x_a$ is the position of a point before sphere displacement, $x_b$ is the position of the point after
        sphere displacement, and $c$ is the center of the sphere. 
    </p>
    <p>
        Overall this code change involved a small change to implement the equation above and a few larger structural
        changes to how collisions are handled and when sphere moments are updated.
    </p>
    <p>
        The results of this change are in figures 2 and 3 below.
    </p>

    <h4>Shader Changes</h4>
    <p>
        The third major code change we had to make was to enable shaders to show the breaking. To make this change,
        we decided to break in units of triangles for the shader. If a spring is broken, it is marked broken along
        with its point masses. We use this flag as a mask variable to each of the shaders; the shaders set the color
        of a vertex to $(0, 0, 0, 0)$ if it has been broken.
    </p>
    <p>
        The result of this is that the shaders now show holes in the mesh. Although the examples given below are
        jagged, you can image with a higher resolution mesh the breaks appear more fine. Higher resolution meshes
        seemed to slow down our computers unbearably so, and as a result these examples are not included.
    </p>
    <p>
        An example image before this code change is seen in Figure 4. Figures 5 and 6 represent successful breaks
        with the shaders.
    </p>

    <h3>Fracture Modeling</h3>
    <h4>Basic Fracture Modeling</h4>
    <p>
        
    </p>

    <h4>Seam Fracture</h4>
    <p>
        
    </p>

    <h4>Shard Fracture</h4>

    
    <br><br>
    <h2>Results</h2>
    <p>Below are our results, open in a new tab if they load slow.</p>
    <div align="middle">
        <table>
          <tr>
            <td>
            <img src="images/frac_no_resis.gif" width="300px"/>
            <figcaption align="middle">Figure 1: Fracture without Mesh Resistance</figcaption>
            </td>
            <td>
                <img src="images/sphere_bounce.gif" width="300px"/>
                <figcaption align="middle">Figure 2: Mesh Resisting Sphere</figcaption>
            </td>
            <td>
                <img src="images/frac_resis.gif" width="300px"/>
                <figcaption align="middle">Figure 3: Mesh Fracture with Resistance</figcaption>
            </td>
          </tr>
          <tr>
            <td>
            <img src="images/portal.gif" width="300px"/>
            <figcaption align="middle">Figure 4 (The Portal): Fracture before Shader Fix</figcaption>
            </td>
          </tr>
        </table>
    </div>

</body>

</html>